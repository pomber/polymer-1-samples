<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="cg-cloud.html">

<dom-module id="cg-random-cloud">
  <template>

    <cg-cloud coords="[[coords]]"></cg-cloud>

  </template>

  <script>
    Polymer({

      is: 'cg-random-cloud',

      properties: {
        coords: {
          type: Array,
          value: function() {
            return this.generateCoords();
          },
        }
      },

      generateCoords: function() {
        var parts = 6;
        var xs = [];   

        for (var i = 0; i < parts; i++) {          
          xs.push(getRandom(0, 100));
        }
        
        xs.sort(function (a, b) {  return a - b;  });

        var coords = xs.map(function (x, i) {
          var d = getRandom(0,100);          
          var y = getRandom(0,d);
          if (i == 0 || i == parts - 1) {
            y = 100 - d;
          }
          return {
            x: x,
            y: y,
            d: d
          }
        });

        for (var i = 1; i < parts; i++) {
          var xp = coords[i-1].x;
          var yp = coords[i-1].y;
          var dp = coords[i-1].d;
          var d = coords[i].d;
          var r = d / 2;
          var rp = dp / 2;

          if (i==1) {
            coords[i].x = getRandom(xp + rp, xp + dp);
            coords[i].y = getRandom(yp - r, d);
          } else if (i == parts - 1) {
            coords[i].x = getRandom(xp + dp - r, xp + dp);  
          } else {
            coords[i].x = getRandom(xp, xp + dp);
            coords[i].y = getRandom(yp - r, d);
          }
        }

        console.log(JSON.stringify(coords));

        return coords;

        // return [
        //     {x: 0, y: 37, d: 63},
        //     {x: 20, y: 0, d: 100},
        //     {x: 60, y: 10, d: 40},
        //     {x: 60, y: 20, d: 80},
        // ];
      }

    });

    // Returns a random integer between min (included) and max (included)
    function getRandom(min, max) {
      min = Math.ceil(min);
      max = Math.floor(max);
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
  </script>
</dom-module>
